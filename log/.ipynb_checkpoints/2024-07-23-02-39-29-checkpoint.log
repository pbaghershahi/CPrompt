2024-07-23,02:39:29 [INFO] Logging to: ./log/2024-07-23-02-39-29.log
2024-07-23,02:39:29 [INFO] Reading config from: ./config/enzymes.yaml
2024-07-23,02:39:29 [INFO] Namespace(total_iters=10, prompt_method='all_in_one_original', s_dataset='ENZYMES', t_dataset='ENZYMES', prompt_fn='gpf_plus', shift_type='structural', p_shift_intra=0.0, p_shift_inter=0.0, pretrain=True, save_pretrained=False, soft_label=False, add_link_loss=False, attn_with_param=False, empty_pretrained_dir=False, iterative_clustering=False, clutering_iters=3, entropy_div_ratio=3, w_entropy_loss=0.0, w_softmax_loss=0.0, w_domain_loss=0.0, r_reg=0.0, gnn_weight_decay=0.0, weight_decay=0.0, gnn_type='gcn', gnn_num_layers=3, pretrained_path=['./pretrained/GCN_Pretrained_2024-06-25-22-14-04.pth', './pretrained/GCN_Pretrained_2024-06-25-22-16-26.pth', './pretrained/GCN_Pretrained_2024-06-25-22-18-48.pth', './pretrained/GCN_Pretrained_2024-06-25-22-21-11.pth', './pretrained/GCN_Pretrained_2024-06-25-22-23-34.pth', './pretrained/GCN_Pretrained_2024-06-25-22-25-58.pth', './pretrained/GCN_Pretrained_2024-06-25-22-28-22.pth', './pretrained/GCN_Pretrained_2024-06-25-22-30-45.pth', './pretrained/GCN_Pretrained_2024-06-25-22-33-08.pth', './pretrained/GCN_Pretrained_2024-06-25-22-35-32.pth'], gnn_n_epochs=100, gnn_eval_step=10, gnn_h_dim=512, gnn_lr=0.01, gnn_step_size=50, gnn_gamma=0.5, gnn_batch_size=64, gnn_dropout=0.4, n_epochs=50, eval_step=10, h_dim=512, lr=0.01, step_size=50, gamma=0.5, batch_size=64, num_tokens=50, src_ratio=0.5, dropout=0.3, cut_off=0.5, aug_type='feature', light_aug_prob=0.1, light_aug_mode='mask', pos_aug_mode='mask', neg_aug_mode='arbitrary', noise_cov_scale=1.0, noise_mean_shift=1.0, noise_shift_mode='homophily', noise_select_mode='soft', cross_prune=0.8, inner_prune=0.3, num_runs=5, p_raug=0.15, n_raug=0.15, s_split=[0.65, 0.3], t_split=[0.65, 0.3], seed=[1625, 4671, 2745, 2587, 3739, 2752, 4142, 2241, 3036, 2027], config_from_file='./config/enzymes.yaml', config_to_file='', label_reduction=0.0)
2024-07-23,02:39:29 [INFO] ####################################################################################################
2024-07-23,02:39:29 [INFO] Args seeds: [1625, 4671, 2745, 2587, 3739, 2752, 4142, 2241, 3036, 2027]
2024-07-23,02:39:29 [INFO] Source Dataset: ENZYMES, Target Dataset: ENZYMES. Training, Test: Source: [0.65, 0.3], Target: [0.65, 0.3] -- Batch size: 64
2024-07-23,02:39:29 [INFO] All input pretrained paths: ['./pretrained/GCN_Pretrained_2024-06-25-22-14-04.pth', './pretrained/GCN_Pretrained_2024-06-25-22-16-26.pth', './pretrained/GCN_Pretrained_2024-06-25-22-18-48.pth', './pretrained/GCN_Pretrained_2024-06-25-22-21-11.pth', './pretrained/GCN_Pretrained_2024-06-25-22-23-34.pth', './pretrained/GCN_Pretrained_2024-06-25-22-25-58.pth', './pretrained/GCN_Pretrained_2024-06-25-22-28-22.pth', './pretrained/GCN_Pretrained_2024-06-25-22-30-45.pth', './pretrained/GCN_Pretrained_2024-06-25-22-33-08.pth', './pretrained/GCN_Pretrained_2024-06-25-22-35-32.pth']
2024-07-23,02:39:29 [INFO] Started round 0/10 of experiments!
2024-07-23,02:39:29 [INFO] Setting for pretraining: Model: {'gnn_type': 'gcn', 'in_channels': 21, 'hidden_channels': 512, 'out_channels': 6, 'num_layers': 3, 'dropout': 0.4, 'with_bn': False, 'with_head': True} -- Optimizer: {'lr': 0.01, 'scheduler_step_size': 50, 'scheduler_gamma': 0.5, 'weight_decay': 0.0} -- Training: {'n_epochs': 100}
2024-07-23,02:39:29 [INFO] Loading previous pretrained model at ./pretrained/GCN_Pretrained_2024-06-25-22-14-04.pth
2024-07-23,02:39:29 [INFO] Total number of tokens: 50
2024-07-23,02:39:29 [INFO] Prompting method: all_in_one_original -- Setting: Prompting function: gpf_plus -- Target Dataset: ENZYMES
2024-07-23,02:39:29 [INFO] Setting for prompt tuning: Prompt: {'token_dim': 21, 'token_num': 50, 'cross_prune': 0.8, 'inner_prune': 0.3} -- Pretrained Model: {'gnn_type': 'gcn', 'in_channels': 21, 'hidden_channels': 512, 'out_channels': 6, 'num_layers': 3, 'dropout': 0.4, 'with_bn': False, 'with_head': True} -- Optimizer: {'lr': 0.01, 'scheduler_step_size': 50, 'scheduler_gamma': 0.5, 'weight_decay': 0.0} -- Training: {'n_epochs': 50, 'r_reg': 0.0, 'num_classes': 6, 'cut_off': 0.5}
2024-07-23,02:39:29 [INFO] Prompt tuning started: Num runs: 5 -- Eval step: 10
