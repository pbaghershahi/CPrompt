2024-08-09,15:58:39 [INFO] Logging to: ./log/2024-08-09-15-58-39.log
2024-08-09,15:58:39 [INFO] Reading config from: ./config/cora.yaml
2024-08-09,15:58:39 [INFO] Namespace(total_iters=10, prompt_method='fix_match', s_dataset='Cora', t_dataset='Cora', prompt_fn='gpf_plus', shift_type='structural', p_shift_intra=0.0, p_shift_inter=0.0, pretrain=True, save_pretrained=False, soft_label=False, add_link_loss=False, attn_with_param=False, empty_pretrained_dir=False, iterative_clustering=False, clutering_iters=3, entropy_div_ratio=3, w_entropy_loss=0.0, w_softmax_loss=0.0, w_domain_loss=0.0, r_reg=0.0, gnn_weight_decay=0.0, weight_decay=0.0, gnn_type='gcn', gnn_num_layers=3, pretrained_path=['./pretrained/GCN_Pretrained_2024-06-27-18-26-24.pth', './pretrained/GCN_Pretrained_2024-06-27-18-28-59.pth', './pretrained/GCN_Pretrained_2024-06-27-18-31-37.pth', './pretrained/GCN_Pretrained_2024-06-27-18-34-51.pth', './pretrained/GCN_Pretrained_2024-06-27-18-38-21.pth', './pretrained/GCN_Pretrained_2024-06-27-18-41-19.pth', './pretrained/GCN_Pretrained_2024-06-27-18-45-22.pth', './pretrained/GCN_Pretrained_2024-06-27-18-48-10.pth', './pretrained/GCN_Pretrained_2024-06-27-18-51-51.pth', './pretrained/GCN_Pretrained_2024-06-27-18-54-52.pth'], gnn_n_epochs=150, gnn_eval_step=10, gnn_h_dim=512, gnn_lr=0.001, gnn_step_size=50, gnn_gamma=0.5, gnn_batch_size=64, gnn_dropout=0.4, n_epochs=50, eval_step=10, h_dim=512, lr=0.001, step_size=50, gamma=0.5, batch_size=64, num_tokens=-1, src_ratio=0.5, dropout=0.3, cut_off=0.5, aug_type='feature', light_aug_prob=0.1, light_aug_mode='mask', pos_aug_mode='mask', neg_aug_mode='arbitrary', noise_cov_scale=1.0, noise_mean_shift=1.0, noise_shift_mode='pr', noise_select_mode='soft', cross_prune=0.8, inner_prune=0.3, num_runs=5, p_raug=0.4, n_raug=0.15, s_split=[0.3, 0.65], t_split=[0.3, 0.65], seed=[3633, 2251, 4314, 1837, 4207, 4752, 1491, 4165, 1417, 2665], config_from_file='./config/cora.yaml', config_to_file='', label_reduction=0.0)
2024-08-09,15:58:39 [INFO] ####################################################################################################
2024-08-09,15:58:39 [INFO] Args seeds: [3633, 2251, 4314, 1837, 4207, 4752, 1491, 4165, 1417, 2665]
2024-08-09,15:58:39 [INFO] Source Dataset: Cora, Target Dataset: Cora. Training, Test: Source: [0.3, 0.65], Target: [0.3, 0.65] -- Batch size: 64
2024-08-09,15:58:39 [INFO] All input pretrained paths: ['./pretrained/GCN_Pretrained_2024-06-27-18-26-24.pth', './pretrained/GCN_Pretrained_2024-06-27-18-28-59.pth', './pretrained/GCN_Pretrained_2024-06-27-18-31-37.pth', './pretrained/GCN_Pretrained_2024-06-27-18-34-51.pth', './pretrained/GCN_Pretrained_2024-06-27-18-38-21.pth', './pretrained/GCN_Pretrained_2024-06-27-18-41-19.pth', './pretrained/GCN_Pretrained_2024-06-27-18-45-22.pth', './pretrained/GCN_Pretrained_2024-06-27-18-48-10.pth', './pretrained/GCN_Pretrained_2024-06-27-18-51-51.pth', './pretrained/GCN_Pretrained_2024-06-27-18-54-52.pth']
2024-08-09,15:58:39 [INFO] Started round 0/10 of experiments!
2024-08-09,15:58:51 [INFO] Setting for pretraining: Model: {'gnn_type': 'gcn', 'in_channels': 1433, 'hidden_channels': 512, 'out_channels': 7, 'num_layers': 3, 'dropout': 0.4, 'with_bn': False, 'with_head': True} -- Optimizer: {'lr': 0.001, 'scheduler_step_size': 50, 'scheduler_gamma': 0.5, 'weight_decay': 0.0} -- Training: {'n_epochs': 150}
2024-08-09,15:58:51 [INFO] Loading previous pretrained model at ./pretrained/GCN_Pretrained_2024-06-27-18-26-24.pth
2024-08-09,15:58:51 [INFO] Total number of tokens: 5
2024-08-09,15:58:51 [INFO] Prompting method: fix_match -- Setting: Prompting function: gpf_plus -- Target Dataset: Cora
2024-08-09,15:58:51 [INFO] Setting for prompt tuning: Prompt: {'emb_dim': 1433, 'h_dim': 512, 'output_dim': 1433, 'prompt_fn': 'gpf_plus', 'token_num': 5, 'cross_prune': 0.8, 'inner_prune': 0.3, 'attn_with_param': False, 'attn_dropout': 0.3} -- Pretrained Model: {'gnn_type': 'gcn', 'in_channels': 1433, 'hidden_channels': 512, 'out_channels': 7, 'num_layers': 3, 'dropout': 0.4, 'with_bn': False, 'with_head': True} -- Optimizer: {'lr': 0.001, 'scheduler_step_size': 50, 'scheduler_gamma': 0.5, 'weight_decay': 0.0} -- Training: {'aug_type': 'feature', 'pos_aug_mode': 'mask', 'p_raug': 0.4, 'n_epochs': 50, 'r_reg': 0.0, 'soft_label': False, 'clutering_iters': 3, 'iterative_clustering': False, 'entropy_div_ratio': 3, 'w_entropy_loss': 0.0, 'w_softmax_loss': 0.0, 'w_domain_loss': 0.0, 'light_aug_prob': 0.1, 'light_aug_mode': 'mask', 'num_classes': 7, 'cut_off': 0.5}
2024-08-09,15:58:51 [INFO] Prompt tuning started: Num runs: 5 -- Eval step: 10
2024-08-09,15:58:52 [INFO] Pretrained GNN on Source Dataset -- Test Loss: 3.190 -- Test ACC: 0.753 -- Test F1-score: 0.749
2024-08-09,15:58:52 [INFO] Pretrained GNN on Target Dataset Without Prompting: -- Validation Loss: 8.846 -- Validation ACC: 0.522 -- Validation F1-score: 0.487 -- Test Loss: 5.959 -- Test ACC: 0.586 -- Test F1-score: 0.542
2024-08-09,15:58:54 [INFO] Epoch: 0/50 -- Train Loss: 1.066 -- Validation Loss: 8.662 -- Validation ACC: 0.537 -- Validation F1: 0.510
2024-08-09,15:59:05 [INFO] Epoch: 10/50 -- Train Loss: 2.056 -- Validation Loss: 8.251 -- Validation ACC: 0.552 -- Validation F1: 0.525
2024-08-09,15:59:15 [INFO] Epoch: 20/50 -- Train Loss: 0.897 -- Validation Loss: 7.973 -- Validation ACC: 0.537 -- Validation F1: 0.510
2024-08-09,15:59:25 [INFO] Epoch: 30/50 -- Train Loss: 1.485 -- Validation Loss: 7.730 -- Validation ACC: 0.537 -- Validation F1: 0.509
2024-08-09,15:59:35 [INFO] Epoch: 40/50 -- Train Loss: 1.354 -- Validation Loss: 7.695 -- Validation ACC: 0.522 -- Validation F1: 0.487
2024-08-09,15:59:39 [INFO] Epoch: 44/50 -- Train Loss: 1.272 -- Validation Loss: 7.652 -- Validation ACC: 0.507 -- Validation F1: 0.472
2024-08-09,15:59:40 [INFO] Epoch: 45/50 -- Train Loss: 0.862 -- Validation Loss: 7.629 -- Validation ACC: 0.522 -- Validation F1: 0.487
2024-08-09,15:59:41 [INFO] Epoch: 46/50 -- Train Loss: 0.712 -- Validation Loss: 7.611 -- Validation ACC: 0.522 -- Validation F1: 0.487
2024-08-09,15:59:43 [INFO] Epoch: 47/50 -- Train Loss: 0.428 -- Validation Loss: 7.606 -- Validation ACC: 0.522 -- Validation F1: 0.487
2024-08-09,15:59:44 [INFO] Epoch: 48/50 -- Train Loss: 0.317 -- Validation Loss: 7.588 -- Validation ACC: 0.522 -- Validation F1: 0.487
2024-08-09,15:59:45 [INFO] Epoch: 49/50 -- Train Loss: 0.325 -- Validation Loss: 7.576 -- Validation ACC: 0.522 -- Validation F1: 0.486
2024-08-09,15:59:45 [INFO] Run 0/5: Average Over Last 6 epochs -- Valid ACC: 0.5199004975124378 -- Valid F1-score: 0.48406562705834705
2024-08-09,15:59:45 [INFO] Test Results of Run 0/5: -- Test Loss: 4.961 -- Test ACC: 0.594 -- Test F1: 0.543
2024-08-09,15:59:47 [INFO] Epoch: 0/50 -- Train Loss: 1.320 -- Validation Loss: 8.627 -- Validation ACC: 0.537 -- Validation F1: 0.510
