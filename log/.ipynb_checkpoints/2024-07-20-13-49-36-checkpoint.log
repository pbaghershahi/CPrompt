2024-07-20,13:49:36 [INFO] Logging to: ./log/2024-07-20-13-49-36.log
2024-07-20,13:49:36 [INFO] Reading config from: ./config/pubmed.yaml
2024-07-20,13:49:36 [INFO] Namespace(total_iters=10, prompt_method='flex_match', s_dataset='PubMed', t_dataset='PubMed', prompt_fn='gpf_plus', shift_type='structural', p_shift_intra=0.0, p_shift_inter=0.0, pretrain=True, save_pretrained=False, soft_label=False, add_link_loss=False, attn_with_param=False, empty_pretrained_dir=False, iterative_clustering=False, clutering_iters=3, entropy_div_ratio=3, w_entropy_loss=0.0, w_softmax_loss=0.0, w_domain_loss=0.0, r_reg=0.0, gnn_weight_decay=0.0, weight_decay=0.0, gnn_type='gcn', gnn_num_layers=3, pretrained_path=['./pretrained/GCN_Pretrained_2024-07-19-22-45-14.pth', './pretrained/GCN_Pretrained_2024-07-19-22-55-45.pth', './pretrained/GCN_Pretrained_2024-07-19-23-07-06.pth', './pretrained/GCN_Pretrained_2024-07-19-23-18-19.pth', './pretrained/GCN_Pretrained_2024-07-19-23-29-41.pth', './pretrained/GCN_Pretrained_2024-07-19-23-40-55.pth', './pretrained/GCN_Pretrained_2024-07-19-23-52-08.pth', './pretrained/GCN_Pretrained_2024-07-20-00-03-23.pth', './pretrained/GCN_Pretrained_2024-07-20-00-14-46.pth', './pretrained/GCN_Pretrained_2024-07-20-00-26-14.pth'], gnn_n_epochs=100, gnn_eval_step=10, gnn_h_dim=512, gnn_lr=0.001, gnn_step_size=50, gnn_gamma=0.5, gnn_batch_size=64, gnn_dropout=0.4, n_epochs=50, eval_step=10, h_dim=512, lr=0.001, step_size=50, gamma=0.5, batch_size=64, num_tokens=-1, src_ratio=0.5, dropout=0.3, cut_off=0.3, aug_type='feature', light_aug_prob=0.1, light_aug_mode='mask', pos_aug_mode='mask', neg_aug_mode='arbitrary', noise_cov_scale=1.0, noise_mean_shift=1.0, noise_shift_mode='homophily', noise_select_mode='soft', cross_prune=0.8, inner_prune=0.3, num_runs=5, p_raug=0.15, n_raug=0.15, s_split=[0.3, 0.65], t_split=[0.3, 0.65], seed=[3170, 2470, 2044, 3616, 4152, 4700, 4941, 2529, 4934, 4375], config_from_file='./config/pubmed.yaml', config_to_file='', label_reduction=0.0)
2024-07-20,13:49:36 [INFO] ####################################################################################################
2024-07-20,13:49:36 [INFO] Args seeds: [3170, 2470, 2044, 3616, 4152, 4700, 4941, 2529, 4934, 4375]
2024-07-20,13:49:36 [INFO] Source Dataset: PubMed, Target Dataset: PubMed. Training, Test: Source: [0.3, 0.65], Target: [0.3, 0.65] -- Batch size: 64
2024-07-20,13:49:36 [INFO] All input pretrained paths: ['./pretrained/GCN_Pretrained_2024-07-19-22-45-14.pth', './pretrained/GCN_Pretrained_2024-07-19-22-55-45.pth', './pretrained/GCN_Pretrained_2024-07-19-23-07-06.pth', './pretrained/GCN_Pretrained_2024-07-19-23-18-19.pth', './pretrained/GCN_Pretrained_2024-07-19-23-29-41.pth', './pretrained/GCN_Pretrained_2024-07-19-23-40-55.pth', './pretrained/GCN_Pretrained_2024-07-19-23-52-08.pth', './pretrained/GCN_Pretrained_2024-07-20-00-03-23.pth', './pretrained/GCN_Pretrained_2024-07-20-00-14-46.pth', './pretrained/GCN_Pretrained_2024-07-20-00-26-14.pth']
2024-07-20,13:49:36 [INFO] Started round 0/10 of experiments!
2024-07-20,13:50:01 [INFO] Setting for pretraining: Model: {'gnn_type': 'gcn', 'in_channels': 500, 'hidden_channels': 512, 'out_channels': 3, 'num_layers': 3, 'dropout': 0.4, 'with_bn': False, 'with_head': True} -- Optimizer: {'lr': 0.001, 'scheduler_step_size': 50, 'scheduler_gamma': 0.5, 'weight_decay': 0.0} -- Training: {'n_epochs': 100}
2024-07-20,13:50:01 [INFO] Loading previous pretrained model at ./pretrained/GCN_Pretrained_2024-07-19-22-45-14.pth
2024-07-20,13:50:02 [INFO] Total number of tokens: 4
2024-07-20,13:50:02 [INFO] Prompting method: flex_match -- Setting: Prompting function: gpf_plus -- Target Dataset: PubMed
2024-07-20,13:50:02 [INFO] Setting for prompt tuning: Prompt: {'emb_dim': 500, 'h_dim': 512, 'output_dim': 500, 'prompt_fn': 'gpf_plus', 'token_num': 4, 'cross_prune': 0.8, 'inner_prune': 0.3, 'attn_with_param': False, 'attn_dropout': 0.3} -- Pretrained Model: {'gnn_type': 'gcn', 'in_channels': 500, 'hidden_channels': 512, 'out_channels': 3, 'num_layers': 3, 'dropout': 0.4, 'with_bn': False, 'with_head': True} -- Optimizer: {'lr': 0.001, 'scheduler_step_size': 50, 'scheduler_gamma': 0.5, 'weight_decay': 0.0} -- Training: {'aug_type': 'feature', 'pos_aug_mode': 'mask', 'p_raug': 0.15, 'n_epochs': 50, 'r_reg': 0.0, 'soft_label': False, 'clutering_iters': 3, 'iterative_clustering': False, 'entropy_div_ratio': 3, 'w_entropy_loss': 0.0, 'w_softmax_loss': 0.0, 'w_domain_loss': 0.0, 'light_aug_prob': 0.1, 'light_aug_mode': 'mask', 'num_classes': 3, 'cut_off': 0.3}
2024-07-20,13:50:02 [INFO] Prompt tuning started: Num runs: 5 -- Eval step: 10
2024-07-20,13:50:03 [INFO] Pretrained GNN on Source Dataset -- Test Loss: 5.373 -- Test ACC: 0.794 -- Test F1-score: 0.779
2024-07-20,13:50:04 [INFO] Pretrained GNN on Target Dataset Without Prompting: -- Validation Loss: 25.493 -- Validation ACC: 0.557 -- Validation F1-score: 0.542 -- Test Loss: 20.008 -- Test ACC: 0.584 -- Test F1-score: 0.569
2024-07-20,13:50:07 [INFO] Epoch: 0/50 -- Train Loss: 0.015 -- Validation Loss: 23.812 -- Validation ACC: 0.549 -- Validation F1: 0.538
2024-07-20,13:50:29 [INFO] Epoch: 10/50 -- Train Loss: 0.000 -- Validation Loss: 16.492 -- Validation ACC: 0.543 -- Validation F1: 0.532
2024-07-20,13:50:50 [INFO] Epoch: 20/50 -- Train Loss: 0.418 -- Validation Loss: 12.248 -- Validation ACC: 0.543 -- Validation F1: 0.531
2024-07-20,13:51:13 [INFO] Epoch: 30/50 -- Train Loss: 0.811 -- Validation Loss: 10.331 -- Validation ACC: 0.545 -- Validation F1: 0.533
2024-07-20,13:51:35 [INFO] Epoch: 40/50 -- Train Loss: 0.762 -- Validation Loss: 9.647 -- Validation ACC: 0.547 -- Validation F1: 0.532
2024-07-20,13:51:44 [INFO] Epoch: 44/50 -- Train Loss: 0.000 -- Validation Loss: 9.628 -- Validation ACC: 0.543 -- Validation F1: 0.530
2024-07-20,13:51:46 [INFO] Epoch: 45/50 -- Train Loss: 0.000 -- Validation Loss: 9.630 -- Validation ACC: 0.545 -- Validation F1: 0.530
2024-07-20,13:51:49 [INFO] Epoch: 46/50 -- Train Loss: 0.109 -- Validation Loss: 9.674 -- Validation ACC: 0.545 -- Validation F1: 0.531
2024-07-20,13:51:51 [INFO] Epoch: 47/50 -- Train Loss: 0.000 -- Validation Loss: 9.642 -- Validation ACC: 0.545 -- Validation F1: 0.531
2024-07-20,13:51:54 [INFO] Epoch: 48/50 -- Train Loss: 0.677 -- Validation Loss: 9.659 -- Validation ACC: 0.541 -- Validation F1: 0.527
2024-07-20,13:51:56 [INFO] Epoch: 49/50 -- Train Loss: 0.558 -- Validation Loss: 9.216 -- Validation ACC: 0.539 -- Validation F1: 0.528
2024-07-20,13:51:56 [INFO] Run 0/5: Average Over Last 6 epochs -- Valid ACC: 0.5426829268292682 -- Valid F1-score: 0.5293405950069427
2024-07-20,13:51:58 [INFO] Test Results of Run 0/5: -- Test Loss: 6.656 -- Test ACC: 0.571 -- Test F1: 0.560
2024-07-20,13:52:01 [INFO] Epoch: 0/50 -- Train Loss: 0.000 -- Validation Loss: 25.384 -- Validation ACC: 0.541 -- Validation F1: 0.527
2024-07-20,13:52:23 [INFO] Epoch: 10/50 -- Train Loss: 0.523 -- Validation Loss: 18.462 -- Validation ACC: 0.561 -- Validation F1: 0.547
2024-07-20,13:52:45 [INFO] Epoch: 20/50 -- Train Loss: 0.000 -- Validation Loss: 15.594 -- Validation ACC: 0.545 -- Validation F1: 0.534
2024-07-20,13:53:07 [INFO] Epoch: 30/50 -- Train Loss: 0.024 -- Validation Loss: 12.528 -- Validation ACC: 0.545 -- Validation F1: 0.533
2024-07-20,13:53:30 [INFO] Epoch: 40/50 -- Train Loss: 0.381 -- Validation Loss: 11.231 -- Validation ACC: 0.549 -- Validation F1: 0.538
2024-07-20,13:53:39 [INFO] Epoch: 44/50 -- Train Loss: 0.000 -- Validation Loss: 10.672 -- Validation ACC: 0.541 -- Validation F1: 0.530
2024-07-20,13:53:41 [INFO] Epoch: 45/50 -- Train Loss: 0.000 -- Validation Loss: 10.533 -- Validation ACC: 0.545 -- Validation F1: 0.535
2024-07-20,13:53:44 [INFO] Epoch: 46/50 -- Train Loss: 0.080 -- Validation Loss: 10.471 -- Validation ACC: 0.547 -- Validation F1: 0.536
2024-07-20,13:53:46 [INFO] Epoch: 47/50 -- Train Loss: 0.439 -- Validation Loss: 10.550 -- Validation ACC: 0.551 -- Validation F1: 0.539
2024-07-20,13:53:49 [INFO] Epoch: 48/50 -- Train Loss: 0.449 -- Validation Loss: 10.558 -- Validation ACC: 0.551 -- Validation F1: 0.540
2024-07-20,13:53:51 [INFO] Epoch: 49/50 -- Train Loss: 0.776 -- Validation Loss: 10.712 -- Validation ACC: 0.549 -- Validation F1: 0.537
2024-07-20,13:53:51 [INFO] Run 1/5: Average Over Last 6 epochs -- Valid ACC: 0.5470867208672087 -- Valid F1-score: 0.5361089607079824
2024-07-20,13:53:53 [INFO] Test Results of Run 1/5: -- Test Loss: 7.750 -- Test ACC: 0.573 -- Test F1: 0.560
2024-07-20,13:53:56 [INFO] Epoch: 0/50 -- Train Loss: 0.000 -- Validation Loss: 21.761 -- Validation ACC: 0.545 -- Validation F1: 0.531
2024-07-20,13:54:18 [INFO] Epoch: 10/50 -- Train Loss: 1.695 -- Validation Loss: 15.971 -- Validation ACC: 0.557 -- Validation F1: 0.547
2024-07-20,13:54:40 [INFO] Epoch: 20/50 -- Train Loss: 0.279 -- Validation Loss: 13.564 -- Validation ACC: 0.528 -- Validation F1: 0.518
2024-07-20,13:55:02 [INFO] Epoch: 30/50 -- Train Loss: 1.008 -- Validation Loss: 11.450 -- Validation ACC: 0.528 -- Validation F1: 0.519
2024-07-20,13:55:23 [INFO] Epoch: 40/50 -- Train Loss: 0.581 -- Validation Loss: 11.316 -- Validation ACC: 0.539 -- Validation F1: 0.524
2024-07-20,13:55:32 [INFO] Epoch: 44/50 -- Train Loss: 0.304 -- Validation Loss: 11.284 -- Validation ACC: 0.541 -- Validation F1: 0.527
2024-07-20,13:55:35 [INFO] Epoch: 45/50 -- Train Loss: 0.433 -- Validation Loss: 11.026 -- Validation ACC: 0.541 -- Validation F1: 0.526
2024-07-20,13:55:37 [INFO] Epoch: 46/50 -- Train Loss: 1.945 -- Validation Loss: 10.845 -- Validation ACC: 0.545 -- Validation F1: 0.530
2024-07-20,13:55:40 [INFO] Epoch: 47/50 -- Train Loss: 0.000 -- Validation Loss: 10.815 -- Validation ACC: 0.545 -- Validation F1: 0.530
2024-07-20,13:55:43 [INFO] Epoch: 48/50 -- Train Loss: 0.000 -- Validation Loss: 10.857 -- Validation ACC: 0.545 -- Validation F1: 0.530
2024-07-20,13:55:45 [INFO] Epoch: 49/50 -- Train Loss: 0.756 -- Validation Loss: 10.349 -- Validation ACC: 0.539 -- Validation F1: 0.526
2024-07-20,13:55:45 [INFO] Run 2/5: Average Over Last 6 epochs -- Valid ACC: 0.5423441734417345 -- Valid F1-score: 0.5280324121316274
2024-07-20,13:55:47 [INFO] Test Results of Run 2/5: -- Test Loss: 7.527 -- Test ACC: 0.573 -- Test F1: 0.561
2024-07-20,13:55:49 [INFO] Epoch: 0/50 -- Train Loss: 0.039 -- Validation Loss: 24.494 -- Validation ACC: 0.545 -- Validation F1: 0.527
2024-07-20,13:56:11 [INFO] Epoch: 10/50 -- Train Loss: 0.000 -- Validation Loss: 16.853 -- Validation ACC: 0.539 -- Validation F1: 0.530
2024-07-20,13:56:33 [INFO] Epoch: 20/50 -- Train Loss: 0.611 -- Validation Loss: 14.424 -- Validation ACC: 0.543 -- Validation F1: 0.530
2024-07-20,13:56:55 [INFO] Epoch: 30/50 -- Train Loss: 0.634 -- Validation Loss: 13.209 -- Validation ACC: 0.545 -- Validation F1: 0.527
